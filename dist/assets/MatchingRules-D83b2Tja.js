import{a as $,g as q,b as z,e as F,f as j}from"./salary-BQjop686.js";import{_ as A,r as d,n as L,c as x,o as g,b as l,w as o,d as n,y as c,t as G,e as v,F as H,h as K,a as r,E as P,j as Q}from"./index-DUy0cMb6.js";import"./request-CbeY7Xks.js";const W={class:"matching-rules"},X={class:"card-header"},Y={class:"dialog-footer"},Z={__name:"MatchingRules",setup(ee){const V=d([]),w=d([]),i=d(!1),y=d(""),s=d({name:"",description:"",priority:0,is_active:!0,conditions:"{}",salary_items:[]}),_=d(null),f=async()=>{try{const a=await $();a.code===0&&(V.value=a.data)}catch{r.error("获取匹配规则列表失败")}},k=async()=>{try{const a=await q();a.code===0&&(w.value=a.data)}catch{r.error("获取薪酬项列表失败")}},C=()=>{y.value="新增匹配规则",s.value={name:"",description:"",priority:0,is_active:!0,conditions:"{}",salary_items:[]},_.value=null,i.value=!0},M=a=>{y.value="编辑匹配规则",s.value={...a,conditions:typeof a.conditions=="string"?a.conditions:JSON.stringify(a.conditions),salary_items:typeof a.salary_items=="string"?JSON.parse(a.salary_items):a.salary_items},_.value=a.id,i.value=!0},S=a=>{P.confirm("确定要删除该匹配规则吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{(await z(a.id)).code===0&&(r.success("删除成功"),f())}catch{r.error("删除失败")}})},B=async()=>{try{const a={...s.value,conditions:s.value.conditions,salary_items:JSON.stringify(s.value.salary_items)};_.value?(await F(_.value,a)).code===0&&(r.success("更新成功"),i.value=!1,f()):(await j(a)).code===0&&(r.success("创建成功"),i.value=!1,f())}catch{r.error("操作失败")}};return L(()=>{f(),k()}),(a,e)=>{const m=n("el-button"),p=n("el-table-column"),N=n("el-tag"),R=n("el-table"),U=n("el-card"),b=n("el-input"),u=n("el-form-item"),E=n("el-input-number"),I=n("el-switch"),h=n("el-option"),J=n("el-select"),O=n("el-form"),T=n("el-dialog");return g(),x("div",W,[l(U,{class:"box-card"},{header:o(()=>[v("div",X,[e[9]||(e[9]=v("span",null,"匹配规则管理",-1)),l(m,{type:"primary",onClick:C},{default:o(()=>e[8]||(e[8]=[c("新增匹配规则")])),_:1})])]),default:o(()=>[l(R,{data:V.value,style:{width:"100%"}},{default:o(()=>[l(p,{prop:"name",label:"名称"}),l(p,{prop:"description",label:"描述"}),l(p,{prop:"priority",label:"优先级"}),l(p,{prop:"is_active",label:"状态"},{default:o(t=>[l(N,{type:t.row.is_active?"success":"info"},{default:o(()=>[c(G(t.row.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(p,{label:"操作",width:"200"},{default:o(t=>[l(m,{size:"small",onClick:D=>M(t.row)},{default:o(()=>e[10]||(e[10]=[c("编辑")])),_:2},1032,["onClick"]),l(m,{size:"small",type:"danger",onClick:D=>S(t.row)},{default:o(()=>e[11]||(e[11]=[c("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(T,{title:y.value,modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value=t),width:"60%"},{footer:o(()=>[v("span",Y,[l(m,{onClick:e[6]||(e[6]=t=>i.value=!1)},{default:o(()=>e[13]||(e[13]=[c("取消")])),_:1}),l(m,{type:"primary",onClick:B},{default:o(()=>e[14]||(e[14]=[c("确定")])),_:1})])]),default:o(()=>[l(O,{model:s.value,"label-width":"120px"},{default:o(()=>[l(u,{label:"名称",required:""},{default:o(()=>[l(b,{modelValue:s.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.name=t)},null,8,["modelValue"])]),_:1}),l(u,{label:"描述"},{default:o(()=>[l(b,{modelValue:s.value.description,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.description=t),type:"textarea"},null,8,["modelValue"])]),_:1}),l(u,{label:"优先级",required:""},{default:o(()=>[l(E,{modelValue:s.value.priority,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.priority=t),min:0,max:100},null,8,["modelValue"])]),_:1}),l(u,{label:"状态"},{default:o(()=>[l(I,{modelValue:s.value.is_active,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.is_active=t)},null,8,["modelValue"])]),_:1}),l(u,{label:"匹配条件"},{default:o(()=>[l(b,{modelValue:s.value.conditions,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.conditions=t),type:"textarea",rows:4},null,8,["modelValue"]),e[12]||(e[12]=v("div",{class:"form-tip"},"请输入JSON格式的匹配条件",-1))]),_:1}),l(u,{label:"关联薪酬项"},{default:o(()=>[l(J,{modelValue:s.value.salary_items,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.salary_items=t),multiple:"",filterable:"",placeholder:"请选择薪酬项",style:{width:"100%"}},{default:o(()=>[(g(!0),x(H,null,K(w.value,t=>(g(),Q(h,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},oe=A(Z,[["__scopeId","data-v-96c80da9"]]);export{oe as default};
